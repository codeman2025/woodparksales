<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slushie Picker</title>
    <script type="module">
        // Firebase SDK Imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBVUrnaxeUHnPgXq7reIO-ZG3DptpF0P0k",
            authDomain: "slushiepicker.firebaseapp.com",
            projectId: "slushiepicker",
            storageBucket: "slushiepicker.firebasestorage.app",
            messagingSenderId: "753485351126",
            appId: "1:753485351126:web:9696c75375fc212f6de177",
            measurementId: "G-C0TTW8CDCF"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Function to send order to Firestore
        function sendOrderToFirestore(flavor, size, totalPrice) {
            addDoc(collection(db, "orders"), {
                flavor: flavor,
                size: size,
                price: totalPrice,
                timestamp: serverTimestamp()
            })
            .then(() => {
                console.log("Order sent to Firestore!");
                document.getElementById("result").innerHTML = "Order Sent! ðŸŽ‰";
            })
            .catch((error) => {
                console.error("Error sending order: ", error);
                document.getElementById("result").innerHTML = "Error sending order! Please try again.";
            });
        }

        // Slushie order function
        function mixSlushie() {
            const flavorSelect = document.getElementById('flavor');
            const sizeSelect = document.getElementById('size');
            const resultDiv = document.getElementById('result');
            const button = document.getElementById('mixButton');

            // Disable button to prevent multiple submissions
            button.disabled = true;
            button.innerHTML = "Mixing...";

            // Add animation to button
            button.classList.add("mixing");

            const flavors = Array.from(flavorSelect.selectedOptions).map(option => option.text).join(", ");
            const size = sizeSelect.value;

            let basePrice = 0;
            let flavorCost = 0;

            if (size === "small") basePrice = 2;
            else if (size === "medium") basePrice = 3;
            else if (size === "large") basePrice = 4;

            const extraFlavors = flavorSelect.selectedOptions.length - 1;
            flavorCost = extraFlavors * 0.5;

            const totalPrice = (basePrice + flavorCost).toFixed(2);

            if (flavors && size) {
                resultDiv.innerHTML = `Your ${size} slushie: ${flavors} <br> Total price: â‚¬${totalPrice}`;
                sendOrderToFirestore(flavors, size, totalPrice);
            } else {
                resultDiv.innerHTML = "Please select both a flavor and size.";
            }

            // After animation, reset button
            setTimeout(() => {
                button.disabled = false;
                button.innerHTML = "Mix It!";
                button.classList.remove("mixing");
            }, 2000);  // Reset after 2 seconds
        }
    </script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f0f4f8;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        select, button {
            margin: 10px 0;
            padding: 10px;
            font-size: 16px;
            border-radius: 5px;
            border: 1px solid #ddd;
            width: 100%;
        }

        button {
            background-color: #3498db;
            color: white;
            cursor: pointer;
            border: none;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #2980b9;
        }

        select {
            background-color: #ecf0f1;
        }

        #result {
            margin-top: 20px;
            font-size: 18px;
            color: #2c3e50;
        }

        /* Animation when button is clicked */
        button.mixing {
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <h1>Slushie Picker</h1>

    <div class="container">
        <label for="flavor">Choose your flavors:</label>
        <select id="flavor" multiple>
            <option value="ribena">Ribena (Apple & Blackcurrant)</option>
            <option value="lime">Lime</option>
            <option value="plain">Plain</option>
        </select>

        <label for="size">Choose your size:</label>
        <select id="size">
            <option value="small">Small</option>
            <option value="medium">Medium</option>
            <option value="large">Large</option>
        </select>

        <button id="mixButton" onclick="mixSlushie()">Mix It!</button>

        <div id="result"></div>
    </div>
</body>
</html>
